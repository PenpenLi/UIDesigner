---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by aaa.
--- DateTime: 2019/5/16 20:26
---
local UIBaseComponent = BaseClass("UIBaseComponent", Updatable)
local function OnCreate(self,trans,relative_path)
    self.unity_anim = UIUtil.FindComponent(trans, typeof(CS.UnityEngine.Animator), relative_path)
    self.isPlaying = false
end

local function Play(self,anim_name,layer,normalized,play_end)
    if  IsNull(self.unity_anim)   then
        return
    end
    self.unity_anim:Play(anim_name,layer,normalized)
    self.isPlaying = true
    self.play_anim = anim_name
    self.play_end = play_end
    if self.play_end then
        self:EnableUpdate(true)
    end

end

local function CrossFade(self,anim_name,trans_time,play_end)
    if  IsNull(self.unity_anim)   then
        return
    end
    self.unity_anim:CrossFade(anim_name,trans_time)
    self.play_end = play_end
    if self.play_end then
        self:EnableUpdate(true)
    end
end

local function Update(self)
    if self.isPlaying then
        local info =  self.unity_anim:GetCurrentAnimatorStateInfo(0);
        if info:IsName(self.play_anim) then
            if info.normalizedTime > 1 then
                self.isPlaying = false
                if self.play_end ~= nil then
                    self.play_end()
                end
                self:EnableUpdate(false)
            end
        end
    end
end
local function OnDestroy(self)
    if self.isPlaying then
        self.isPlaying = false
        self:EnableUpdate(false)
    end
end
UIBaseComponent.OnCreate = OnCreate
UIBaseComponent.Update = Update
UIBaseComponent.Play = Play
UIBaseComponent.OnDestroy = OnDestroy
UIBaseComponent.CrossFade = CrossFade
return UIBaseComponent