---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by ljl.
--- DateTime: 2019/2/26 15:33
---
local RecentlyWarpItem=BaseClass("RecentlyWarpItem",UIWrapComponent)
local base = UIWrapComponent
local TaskAwardItem = require "UI.UIDailyTask.Component.TaskAwardItem"

local function OnCreate(self)
    base.OnCreate(self)
    --组建初始化
    self.comeBtn = self:AddComponent(UIButton,"comeBtn")
    self.comeBtn:SetOnClick(function ()
        LJAudioManger:GetInstance():PlayVoice("UI_CommonClick")
        self.view:GetAchievementTaskAward(self.single_data.id)
    end)
    self.name_text = self:AddComponent(UIText, "nameText")
    self.des_text = self:AddComponent(UIText,"littlenameText")
    self.score_text = self:AddComponent(UIText,"scoreText")
    self.has_img = UIUtil.FindTrans(self.transform,"hasgetimg")
    self.grid = self:AddComponent(UIBaseContainer,"grid")
    local itemCount = self.grid.transform.childCount
    self.awardPrbList = {}
    for i = 0, itemCount - 1 do
        local singleTrans = self.grid.transform:GetChild(i)
        local pass = TaskAwardItem.New(self,singleTrans.gameObject)
        pass:OnCreate()
        table.insert(self.awardPrbList,pass)
    end
end

-- 组件被复用时回调该函数，执行组件的刷新
local function OnRefresh(self,real_index)
    local data=self.view.recently_data[real_index+1]
    self.single_data = data
    if data==nil then
        return
    end

    self.name_text:SetText(data.name)
    self.des_text:SetText(data.des)
    if data.status == 0 then
        self.has_img.gameObject:SetActive(false)
        self.comeBtn.gameObject:SetActive(false)
    elseif data.status == 1 then
        self.has_img.gameObject:SetActive(true)
        self.comeBtn.gameObject:SetActive(false)
    else
        self.has_img.gameObject:SetActive(false)
        self.comeBtn.gameObject:SetActive(true)
    end
    self.awardList = data.reward
    for i, v in ipairs(self.awardPrbList) do
        if self.awardList[i]~=nil then
            v.gameObject:SetActive(true)
            v:Refresh(self.awardList[i])
        else
            v.gameObject:SetActive(false)
        end
    end

end

RecentlyWarpItem.OnCreate = OnCreate
RecentlyWarpItem.OnRefresh=OnRefresh

return RecentlyWarpItem