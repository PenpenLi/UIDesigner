---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by LJ095.
--- DateTime: 2019/10/21 15:11
---
local UIlyztMsgWrapItem = BaseClass("UIlyztMsgWrapItem", UIWrapComponent)
local base = UIWrapComponent

local icon_path="frame/icon";
local name_path="name";
local msg_text_path="info";
local dead_obj_path="tipObj";
local red_point_path="redPoint";


local function OnCreate(self)
    base.OnCreate(self)
    self.icon=self:AddComponent(UIImage,icon_path,AtlasConfig.DynamicTex);
    self.nameText=self:AddComponent(UIText,name_path);
    self.msgText=self:AddComponent(UIText,msg_text_path);
    self.deadObj=UIUtil.FindTrans(self.transform,dead_obj_path);
    self.redPoint=UIUtil.FindTrans(self.transform,red_point_path);
    self.selfBtn=self:AddComponent(UIButton,"");
    self.selfBtn:SetOnClick(function()
        self.view.ctrl:CloseSelf();
        UIManager:GetInstance():OpenWindow(UIWindowNames.UILYZTChat,self.npcId);

    end)
end

local function OnRefresh(self, real_index)
    self.realIndex=real_index+1;
    local data=self.view.model.msgList[self.realIndex];
    self.npcId=data.id;
    if data then
        self.nameText:SetText(data.name);
        local showStr="";
        if DataUtil.GetStringLength(data.info)>13 then
            showStr=UIUtil.StringSub(data.info,0,13).."......";
        else
            showStr=data.info;
        end
        self.msgText:SetText(showStr);
        self.deadObj.transform.gameObject:SetActive(data.isDead);
        self.icon:SetSpriteName(data.icon);
        --self.redPoint.transform.gameObject:SetActive(data.isNewInfo);
    end

end


UIlyztMsgWrapItem.OnCreate = OnCreate
UIlyztMsgWrapItem.OnRefresh = OnRefresh
return UIlyztMsgWrapItem