---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2019/9/20 10:4
local UIWeaponItem = BaseClass("UIWeaponItem", UIBaseContainer)
local base = UIBaseContainer

local function SetPointPos(self)
    local pos_X=0
    local pos_Y=0
    local rao_z=0
    local x,y=math.modf(self.index/2)
    rao_z=y==0 and 45 or 0
    if y== 0then
        pos_X= self.index>4 and -54.6 or 54.6
    else
        if self.index==5 or self.index==1then
            pos_X=0
        else
            pos_X= self.index>4 and -78 or 78
        end
    end
    if y== 0then
        pos_Y = (self.index==2 or self.index==8) and 54.6 or -54.6
    else
        pos_Y=(self.index==3 or self.index==7) and 0 or (self.index>4 and -78 or 78)
    end
    self.point.localPosition = Vector3.New( pos_X, pos_Y, 0);
    self.point.localEulerAngles = Vector3.New( 0,0, rao_z);
end
local function OnCreate(self,index,partent)
    base.OnCreate(self)
    self.index=index
    self.parent=partent
    self.point=UIUtil.FindTrans(self.transform,"point")
    self.name=self:AddComponent(UIText,"name_bg/name")
    self.lv=self:AddComponent(UIText,"lv_bg/lv")
    self.icon=self:AddComponent(UIImage,"icon",AtlasConfig.DynamicTex)
    self.btn=self:AddComponent(UIButton,"icon")
    self.btn:SetOnClick(function ()
        if self.parent.weapon_switch~=self.index then
            self.parent:SetBtnSiwtch(self.index)
            --DataManager:GetInstance():Broadcast(DataMessageNames.UI_CARD_WEAPON_UPDATE,self.index)
        end
    end)
    self.lock=UIUtil.FindTrans(self.transform,"lock")
    self.lock_des=self:AddComponent(UIText,"lock/lock_des")
    self.red_point=UIUtil.FindTrans(self.transform,"redpoint")
    SetPointPos(self)
end

local function SetData(self,data)
    self.red_point.gameObject:SetActive(RedPointData:GetInstance():GetRedState(tostring(self.parent.cardId).."_4_2_"..self.index))
    self.icon:SetSpriteName(data.icon)
    self.name:SetText(data.name)
    self.lv:SetText(Mathf.Floor(data.level))
    if data.status then
        self.lock.gameObject:SetActive(false)
    else
        self.lock.gameObject:SetActive(true)
        self.lock_des:SetText(data.limit_des)
    end

end
--刷新
local function Refresh(self)
    --是否解锁
end


UIWeaponItem.OnCreate=OnCreate
UIWeaponItem.Refresh=Refresh
UIWeaponItem.SetData = SetData
return UIWeaponItem