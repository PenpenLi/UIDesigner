---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by ljl.
--- DateTime: 2019/5/7 16:37
---
local UIWeaponUseItem=BaseClass("UIWeaponUseItem",UIWrapComponent)
local base = UIWrapComponent


local function OnCreate(self,parent)
    base.OnCreate(self)
    --组建初始化
    self.numText = self:AddComponent(UIText, "num")
    self.iconImg = self:AddComponent(UIImage,"icon", AtlasConfig.DynamicTex)
    self.btn = self:AddComponent(UIButton,"icon")
    self.btn:SetOnClick(function ()
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIItemJumpTip,self.singleData.Id)
    end)
    self.frameImg = self:AddComponent(UIImage,"", AtlasConfig.DynamicTex)
    self.parent = parent
end

-- 组件被复用时回调该函数，执行组件的刷新
local function OnRefresh(self,real_index)
    if self.parent.btn_type==1 then
        self.singleData = self.parent.costBlockList[real_index + 1]
    elseif self.parent.btn_type==2 then
        self.singleData = self.parent.costStrengthList[real_index + 1]
    end
    self.myData = DataUtil.GetData("item")[self.singleData.Id]
    if self.myData ~= nil then
        local haveNum = BackpackData:GetInstance():GetItemNumById(self.singleData.Id)
        self.numText :SetText((haveNum < self.singleData.Val and "<color=#DF4C4CFF>" .. DataUtil.GetDataNumDes(haveNum)  .. "</color>" or DataUtil.GetDataNumDes(haveNum)) .. "/" .. tostring(math.floor(self.singleData.Val)))
        self.iconImg:SetSpriteName(self.myData.Icon)
        --self.frameImg:SetSpriteName("ui_t_c2_027")             --(SpriteDefine:GetItemQualityFrameByType(self.myData.Quality))
        self._index = real_index
        self._id = self.singleData.Id
    end
end

UIWeaponUseItem.OnCreate = OnCreate
UIWeaponUseItem.OnRefresh=OnRefresh

return UIWeaponUseItem