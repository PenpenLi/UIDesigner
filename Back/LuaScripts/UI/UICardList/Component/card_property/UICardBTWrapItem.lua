---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by aaa.
--- DateTime: 2019/5/6 20:56
---
--[[
-- added by wsh @ 2017-12-11
-- UICardPool模块中卡牌列表的可复用Item
--]]

local UICardBTWrapItem = BaseClass("UICardBTWrapItem", UIWrapComponent)
local base = UIWrapComponent

-- 创建
local function OnCreate(self)
    base.OnCreate(self)
    -- 组件初始化
    self._icon_img = self:AddComponent(UIImage, "Icon", AtlasConfig.DynamicTex)
    self._frame_img = self:AddComponent(UIImage, "", AtlasConfig.DynamicTex)
    self._num_txt = self:AddComponent(UIText, "chipNum")
    self.SpImg = UIUtil.FindTrans(self.transform,"chipImg")
    self.info_iconPress=self:AddComponent(UIEventTrigger,"")
    self.info_iconPress:SetOnLongPress(function()
        if self.costid then
            UIManager:GetInstance():OpenWindow(UIWindowNames.UIItemTips,self.costid)
        end
    end,(function()
        UIManager:GetInstance():CloseWindow(UIWindowNames.UIItemTips)
    end),true)
    self.btn = self:AddComponent(UIButton,"Icon")
    self.btn:SetOnClick(function ()
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIItemJumpTip,self.costid)
    end)
    -- 变量初始化
end
local function SetData(self,costData)
    if costData ~= nil then
        self.costid=costData.Id
        self.myData = DataUtil.GetData("item")[costData.Id]
        if self.myData ~= nil then
            local itemInBag = BackpackData:GetInstance():GetItemDataById(costData.Id)
            local haveNum = 0
            if itemInBag ~= nil then
                haveNum = itemInBag.haveNum
            end
            self._num_txt :SetText((haveNum < costData.Val and "<color=#EC6B60FF>" .. DataUtil.GetDataNumDes(haveNum) .. "</color>" or DataUtil.GetDataNumDes(haveNum)) .. "/" .. tostring(math.floor(costData.Val)))
            self._icon_img:SetSpriteName(self.myData.Icon)
            self._frame_img:SetSpriteName(SpriteDefine:GetItemQualityFrameByType(self.myData.Quality))
            if self.myData.ItemType==17 then
                self.SpImg.gameObject:SetActive(true)
            else
                self.SpImg.gameObject:SetActive(false)
            end
            return haveNum >= costData.Val
        end
    end
    return true
end


UICardBTWrapItem.OnCreate = OnCreate
UICardBTWrapItem.SetData = SetData
return UICardBTWrapItem