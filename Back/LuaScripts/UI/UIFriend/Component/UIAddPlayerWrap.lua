---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by aaa.
--- DateTime: 2019/3/1 11:19
---

local UIAddPlayerWrap = BaseClass("UIBaseContainer", UIBaseContainer)
local itemData = DataUtil.GetData("item")
local base = UIBaseContainer

local function AddFriend(self)
    LJAudioManger:GetInstance():PlayVoice("UI_CommonClick")
    self.view:OpenApplyWindow(self.id)
end

local function ConfirmAdd(self)
    LJAudioManger:GetInstance():PlayVoice("UI_CommonClick")
    FriendData:GetInstance():DealFriend(2,self.id)
end
local function CancelAdd(self)
    LJAudioManger:GetInstance():PlayVoice("UI_CommonClick")
    FriendData:GetInstance():DealFriend(3,self.id)
end
-- 创建
local function OnCreate(self,holder)
    base.OnCreate(self)
    self.name_text = self:AddComponent(UIText,"center/name")
    self.info_text =  self:AddComponent(UIText,"center/info")
    self.lv_text = self:AddComponent(UIText,"LvFrame/leftlv")
    self.frame = self:AddComponent(UIImage,"frame",AtlasConfig.DynamicTex)
    self.icon = self:AddComponent(UIImage,"icon",AtlasConfig.DynamicTex)
    self.add_game = UIUtil.FindTrans(self.transform,"add").gameObject
    self.apply_game = UIUtil.FindTrans(self.transform,"apply").gameObject
    self.info_game = UIUtil.FindTrans(self.transform,"center/info").gameObject
    local btn = self:AddComponent(UIButton,"add")
    btn:SetOnClick(self,AddFriend)

    btn = self:AddComponent(UIButton,"apply/confirm")
    btn:SetOnClick(self,ConfirmAdd)
    btn = self:AddComponent(UIButton,"apply/cancel")
    btn:SetOnClick(self,CancelAdd)

    btn = self:AddComponent(UIButton,"frame")
    btn:SetOnClick(self,function()
        if self.holder.current_page == 1 then
            UIManager:GetInstance():OpenWindow(UIWindowNames.UIPlayerFunc,self.id)
        end
    end)

    self.holder = holder
end


-- 组件被复用时回调该函数，执行组件的刷新
local function OnRefresh(self, real_index, check)
    local data =self.holder:GetPlayerDataById(self.holder.player_list[real_index+1])
    self.id = data.id
    self.name_text:SetText(data.name)
    self.info_text:SetText(data.info)
    self.lv_text:SetText(data.lv)
    self.icon:SetSpriteName(itemData[data.head].Icon)
    self.frame:SetSpriteName(SpriteDefine:GetItemQualityFrameByType(itemData[data.head].Quality))
    if self.holder.current_page == 1 then

        self.add_game:SetActive(true)
        self.apply_game:SetActive(false)
        self.info_game:SetActive(false)
    else
        self.info = data.info
        self.add_game:SetActive(false)
        self.apply_game:SetActive(true)
        self.info_game:SetActive(true)
    end


end

UIAddPlayerWrap.OnRefresh = OnRefresh
UIAddPlayerWrap.OnCreate = OnCreate

return UIAddPlayerWrap