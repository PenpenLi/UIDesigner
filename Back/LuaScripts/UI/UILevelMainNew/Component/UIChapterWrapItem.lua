---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by LJ095.
--- DateTime: 2019/5/14 15:31
---

local UIChapterWrapItem = BaseClass("UIChapterWrapItem", UIBaseContainer)
local base = UIWrapComponent

local name_text_path="nameText";
local star_text_path="starImg/starText";
local lock_img_path="lockImg";
local box_img_path="boxImg";
local btn_path="btn";
local star_obj_path="starImg";
local chapter_id_path="chapterIdText";



--创建
local function OnCreate(self)
    base.OnCreate(self)
    self.chapterNameText=self:AddComponent(UIText,name_text_path);
    self.starText=self:AddComponent(UIText,star_text_path);
    self.lockObj=UIUtil.FindTrans(self.transform,lock_img_path);
    self.boxObj=UIUtil.FindTrans(self.transform,box_img_path);
    self.chapterIdText=self:AddComponent(UIText,chapter_id_path);
    self.selfBtn=self:AddComponent(UIButton,btn_path);
    self.selfBtn:SetOnClick(function()
        if self.singleData.lock then
            UISpecial:GetInstance():UITipText(self.singleData.lockTip)
        else
            UIManager:GetInstance():Broadcast(UIMessageNames.UI_CHAPTER_SELECT,self.index);
        end
    end)
    self.starObj=UIUtil.FindTrans(self.transform,star_obj_path);

end

-- 组件被复用时回调该函数，执行组件的刷新
local function OnRefresh(self, real_index,_data)

    self.transform.gameObject:SetActive(_data~=nil)
    self.index=real_index;
    if _data~=nil then
        self.singleData=_data;
        self.starText:SetText(string.format("%s/%s",self.singleData.curStar,self.singleData.totalStar));
        self.lockObj.gameObject:SetActive(self.singleData.lock);
        self.boxObj.gameObject:SetActive(self.singleData.haveAward);
        self.starObj.gameObject:SetActive(not self.singleData.lock);
        self.chapterIdText:SetText(self.index);
        if self.index==self.view.selectChapterIndex  then
            self.view.SetChildParent(self.view.passSelectObj,self.transform,1);
            self.chapterNameText:SetText(string.format("<color=#F9BE00>%s</color>",self.singleData.name));
        else
            if UIUtil.FindTrans(self.transform,"passSelectObj")~=nil then
                self.view.passSelectObj.gameObject:SetActive(false);

            end
            self.chapterNameText:SetText(string.format("<color=#FFFFFF>%s</color>",self.singleData.name));
        end
    end
end

UIChapterWrapItem.OnCreate = OnCreate
UIChapterWrapItem.OnRefresh = OnRefresh

return UIChapterWrapItem