---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by LJ095.
--- DateTime: 2019/2/27 16:33
---

local UISetMainModel = BaseClass("UISetMainModel", UIBaseModel);
local base = UIBaseModel;
local item=DataUtil.GetData("item")
local function OnCreate(self)
    base.OnCreate(self)

end

local function OnEnable(self)
    self:OnRefresh()
end
local function OnRefresh(self)
    --检测当前 声音设置状态
    self.voicestate={music={true,1},sound={true,1},voice={true,1}}
    self.voicestate.music[1] = LJAudioManger:GetInstance():GetAudioMute(1)
    self.voicestate.sound[1] = LJAudioManger:GetInstance():GetAudioMute(2)
    self.voicestate.voice[1] = LJAudioManger:GetInstance():GetAudioMute(3)
    self.voicestate.music[2] = LJAudioManger:GetInstance():GetAudioVolume(1)
    self.voicestate.sound[2] = LJAudioManger:GetInstance():GetAudioVolume(2)
    self.voicestate.voice[2] = LJAudioManger:GetInstance():GetAudioVolume(3)

    --检测当前的音画设置状态 0是流畅 1：精细  2：自定义
    self.yinhuastate = {cursel=1,state={true,true,true,true,true}}
    self.yinhuastate.cursel = QualityManager:GetInstance():GetHuaMianKeyState()
    self.yinhuastate.state[1] = QualityManager:GetInstance():ShadowEnabled()
    self.yinhuastate.state[2] = QualityManager:GetInstance():OutlineEnabled()
    self.yinhuastate.state[3] = QualityManager:GetInstance():SceneEffectEnabled()
    self.yinhuastate.state[4] = QualityManager:GetInstance():BloomEnabled()
    --self.yinhuastate.state[5] = QualityManager:GetInstance():MSAAEnabled()
    --接口修改为QualityManager:GetInstance():GetAAType() 返回值为int
    self.headImg =item[UserData:GetInstance().pHead].Icon
    self.frameImg = SpriteDefine:GetItemQualityFrameByType(item[UserData:GetInstance().pHead].Quality)
end
local function OnDataRefresh(self)
    self:OnRefresh()
    --通知UI刷新
    UIManager:GetInstance():Broadcast(UIMessageNames.UI_SETTTING_ONREFRESH)
end
local function OnAddListener(self)
    base.OnAddListener(self)
    -- UI消息注册
    self:AddUIListener(UIMessageNames.UI_SETTTING_ONDATAREFRESH, OnDataRefresh)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
    -- UI消息注销
    self:RemoveUIListener(UIMessageNames.UI_SETTTING_ONDATAREFRESH, OnDataRefresh)
end
UISetMainModel.OnCreate=OnCreate;
UISetMainModel.OnEnable=OnEnable;
UISetMainModel.OnRefresh=OnRefresh
UISetMainModel.OnDataRefresh=OnDataRefresh
UISetMainModel.OnRemoveListener=OnRemoveListener
UISetMainModel.OnAddListener=OnAddListener
return UISetMainModel