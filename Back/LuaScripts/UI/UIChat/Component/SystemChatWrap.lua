---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by aaa.
--- DateTime: 2019/2/26 14:08
---

local EnumType = {
    God = 1,     --天选
    System = 2,     --系统
    Achievement = 3,    --成就
    Team = 4,     --组队
    None = 5,     --todo
}

local SystemChatWrap = BaseClass("SystemChatWrap", UIWrapComponent)
local base = UIWrapComponent
local function LinkTextCallBack(self, LinkKey)
    local paramList = UIUtil.StringSplitByChar(LinkKey, "_")
    if paramList[1] == "JumpToDRBoss" then
        if paramList[2] then
            paramList[2] = tonumber(paramList[2])
        end
        if paramList[3] then
            paramList[3] = tonumber(paramList[3])
        end
        if paramList[4] then
            paramList[4] = tonumber(paramList[4])
        end
        self.view.ctrl:CloseSelf()
        --根据知道的信息 打开房间信息
        DRBossData:GetInstance():SendSearchMessage(tostring(Mathf.Floor(self.data.roomId)),self.data.chapterId)
    elseif paramList[1] == "JumpToCacoDemon" then
        UIManager:GetInstance():OpenWindow(UIWindowNames.UICacodemon)
    end
end
-- 创建
local function OnCreate(self)
    base.OnCreate(self)
    -- 组件初始化
    self.colbg = self:AddComponent(UIImage, "bgcol", AtlasConfig.DynamicTex)
    self.colbg_Text = self:AddComponent(UIText, "bgcol/Text")
    self.bg = UIUtil.FindComponent(self.transform, typeof(CS.UnityEngine.RectTransform), "bg1")
    self.content = self:AddComponent(UIText, "leftcontent")

    self.content:SetLinkClick(self, LinkTextCallBack)
end

-- 组件被复用时回调该函数，执行组件的刷新
local function OnRefresh(self, real_index, check)
   self.data = self.view.system_list[real_index]
    --local str = "        " .. self.data.content  ---"<color=#FFFFFF00>_</color>" .. self.data.name .. "<color=#FFFFFF00>_</color>"
    self.content:SetText("        "..self.data.content)
    if self.data.type == EnumType.System then
        self.colbg:SetSpriteName("ui_dtex_Other_020")
        self.colbg_Text:SetText("系统")
    elseif self.data.type == EnumType.God then
        self.colbg:SetSpriteName("ui_dtex_Other_018")
        self.colbg_Text:SetText("天选")
    elseif self.data.type == EnumType.Achievement then
        self.colbg:SetSpriteName("ui_dtex_Other_016")
        self.colbg_Text:SetText("成就")
    elseif self.data.type == EnumType.Team then
        self.colbg:SetSpriteName("ui_dtex_Other_017")
        self.colbg_Text:SetText("组队")
    elseif self.data.type == EnumType.None then
        self.colbg:SetSpriteName("ui_dtex_Other_019")
        self.colbg_Text:SetText("")
    end

    self.bg.sizeDelta = self.data.size
    self.bg.gameObject:SetActive(false)
end
SystemChatWrap.OnCreate = OnCreate
SystemChatWrap.OnRefresh = OnRefresh
return SystemChatWrap