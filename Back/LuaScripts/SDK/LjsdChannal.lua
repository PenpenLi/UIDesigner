---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by aaa.
--- DateTime: 2019/9/16 10:42
---
local LjsdChannal = BaseClass("LjsdChannal")

local function GetNoticeData()
    ResourcesManager:GetInstance():DownloadWebResourceAsync(Config.URL_GET_NOTICE_LIST,function (asset)
        --解析数据
        local data = asset.text
        local notice_list = {}
        if type(data) == "string" and #data > 0 then
            local json = require "cjson"
            local noticeData = json.decode(data)
            --Logger.Log("noticeData数据：" ..table.dump(noticeData,nil,15))
            if  noticeData.noticeList~= nil then
                for _, v in ipairs(noticeData.noticeList) do
                    local noteData = {}
                    noteData.id = v.id
                    noteData.type = v.type
                    noteData.name = v.name
                    noteData.isNew = v.isNew
                    noteData.content = v.content
                    table.insert(notice_list,noteData)
                end
            else
                Logger.Log("公告数据为空")
            end
        else
            Logger.Log("解析数据失败")
        end
        NoticeData:GetInstance():UpdateNoticeData(notice_list)
    end)
end
LjsdChannal.GetNoticeData = GetNoticeData
return LjsdChannal