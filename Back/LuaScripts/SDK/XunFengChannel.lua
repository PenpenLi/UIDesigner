---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by aaa.
--- DateTime: 2019/9/16 11:49
---
local XunFengChannel = BaseClass("XunFengChannel")
local function __init(self)

    local jp =CS.UnityEngine.GameObject.Find("JGPush")
    if not IsNull(jp) then
        Logger.Log("----->初始化XunFengChannel")
        local gp = jp:GetComponent(typeof(CS.JGPush))
        gp:SetCallback(self.OnReceivePushData)
    end

end

local function OnReceivePushData(key,info)
    Logger.Log("  key "..tostring(key).."  info "..tostring(info))
end
local function GetNoticeData()
    ResourcesManager:GetInstance():DownloadWebResourceAsync("https://dl.uu.cc/wind/11290/before_login_notice_test.json",function (asset)
        --解析数据
        local data = asset.text
        local notice_list = {}
        if type(data) == "string" and #data > 0 then
            local json = require "cjson"
            local noticeData = json.decode(data)
            Logger.Log("noticeData数据：" ..table.dump(noticeData,nil,15))
            if  noticeData~= nil then
                for _, v in ipairs(noticeData) do
                    local noteData = {}
                    noteData.id = v.id
                    noteData.type = 1
                    noteData.name = v.Title
                    noteData.isNew = 0
                    noteData.content = v.Content
                    table.insert(notice_list,noteData)
                end
            else
                Logger.Log("公告数据为空")
            end
        else
            Logger.Log("解析数据失败")
        end
        NoticeData:GetInstance():UpdateNoticeData(notice_list)
    end)
end
XunFengChannel.__init = __init
XunFengChannel.OnReceivePushData = OnReceivePushData
XunFengChannel.GetNoticeData = GetNoticeData
return XunFengChannel